\section{/\+Users/jselfridge/\+Documents/\+Git\+Hub/\+Black\+Box/inc/mpu.h File Reference}
\label{mpu_8h}\index{/\+Users/jselfridge/\+Documents/\+Git\+Hub/\+Black\+Box/inc/mpu.\+h@{/\+Users/jselfridge/\+Documents/\+Git\+Hub/\+Black\+Box/inc/mpu.\+h}}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ int\+\_\+param\+\_\+s}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \textbf{ get\+\_\+ms}~\textbf{ i2c\+\_\+get\+\_\+ms}
\item 
\#define \textbf{ log\+\_\+i}~printf
\item 
\#define \textbf{ log\+\_\+e}~printf
\item 
\#define \textbf{ delay\+\_\+ms}(t)~usleep(t$\ast$1000)
\item 
\#define \textbf{ min}(a,  b)~( (a $<$ b) ? a \+: b )
\item 
\#define \textbf{ I\+N\+V\+\_\+\+X\+\_\+\+G\+Y\+RO}~(0x40)
\item 
\#define \textbf{ I\+N\+V\+\_\+\+Y\+\_\+\+G\+Y\+RO}~(0x20)
\item 
\#define \textbf{ I\+N\+V\+\_\+\+Z\+\_\+\+G\+Y\+RO}~(0x10)
\item 
\#define \textbf{ I\+N\+V\+\_\+\+X\+Y\+Z\+\_\+\+G\+Y\+RO}~(\textbf{ I\+N\+V\+\_\+\+X\+\_\+\+G\+Y\+RO} $\vert$ \textbf{ I\+N\+V\+\_\+\+Y\+\_\+\+G\+Y\+RO} $\vert$ \textbf{ I\+N\+V\+\_\+\+Z\+\_\+\+G\+Y\+RO})
\item 
\#define \textbf{ I\+N\+V\+\_\+\+X\+Y\+Z\+\_\+\+A\+C\+C\+EL}~(0x08)
\item 
\#define \textbf{ I\+N\+V\+\_\+\+X\+Y\+Z\+\_\+\+C\+O\+M\+P\+A\+SS}~(0x01)
\item 
\#define \textbf{ M\+P\+U\+\_\+\+I\+N\+T\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+D\+A\+T\+A\+\_\+\+R\+E\+A\+DY}~(0x0001)
\item 
\#define \textbf{ M\+P\+U\+\_\+\+I\+N\+T\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+D\+MP}~(0x0002)
\item 
\#define \textbf{ M\+P\+U\+\_\+\+I\+N\+T\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+P\+L\+L\+\_\+\+R\+E\+A\+DY}~(0x0004)
\item 
\#define \textbf{ M\+P\+U\+\_\+\+I\+N\+T\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+I2\+C\+\_\+\+M\+ST}~(0x0008)
\item 
\#define \textbf{ M\+P\+U\+\_\+\+I\+N\+T\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+F\+I\+F\+O\+\_\+\+O\+V\+E\+R\+F\+L\+OW}~(0x0010)
\item 
\#define \textbf{ M\+P\+U\+\_\+\+I\+N\+T\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+Z\+M\+OT}~(0x0020)
\item 
\#define \textbf{ M\+P\+U\+\_\+\+I\+N\+T\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+M\+OT}~(0x0040)
\item 
\#define \textbf{ M\+P\+U\+\_\+\+I\+N\+T\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+F\+R\+E\+E\+\_\+\+F\+A\+LL}~(0x0080)
\item 
\#define \textbf{ M\+P\+U\+\_\+\+I\+N\+T\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+D\+M\+P\+\_\+0}~(0x0100)
\item 
\#define \textbf{ M\+P\+U\+\_\+\+I\+N\+T\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+D\+M\+P\+\_\+1}~(0x0200)
\item 
\#define \textbf{ M\+P\+U\+\_\+\+I\+N\+T\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+D\+M\+P\+\_\+2}~(0x0400)
\item 
\#define \textbf{ M\+P\+U\+\_\+\+I\+N\+T\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+D\+M\+P\+\_\+3}~(0x0800)
\item 
\#define \textbf{ M\+P\+U\+\_\+\+I\+N\+T\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+D\+M\+P\+\_\+4}~(0x1000)
\item 
\#define \textbf{ M\+P\+U\+\_\+\+I\+N\+T\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+D\+M\+P\+\_\+5}~(0x2000)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ mpu\+\_\+init} (int fd, struct \textbf{ int\+\_\+param\+\_\+s} $\ast$int\+\_\+param)
\begin{DoxyCompactList}\small\item\em Initialize hardware. Initial configuration\+:~\newline
Gyro F\+SR\+: +/-\/ 2000\+D\+PS~\newline
Accel F\+SR +/-\/ 2G~\newline
D\+L\+PF\+: 42\+Hz~\newline
F\+I\+FO rate\+: 50\+Hz~\newline
Clock source\+: Gyro P\+LL~\newline
F\+I\+FO\+: Disabled.~\newline
Data ready interrupt\+: Disabled, active low, unlatched. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+init\+\_\+slave} (void)
\item 
int \textbf{ mpu\+\_\+set\+\_\+bypass} (int fd, unsigned char bypass\+\_\+on)
\begin{DoxyCompactList}\small\item\em Set device to bypass mode. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+lp\+\_\+accel\+\_\+mode} (int fd, unsigned short rate)
\begin{DoxyCompactList}\small\item\em Enter low-\/power accel-\/only mode. In low-\/power accel mode, the chip goes to sleep and only wakes up to sample the accelerometer at one of the following frequencies\+: ~\newline
 M\+P\+U6050\+: 1.\+25\+Hz, 5\+Hz, 20\+Hz, 40\+Hz ~\newline
 M\+P\+U6500\+: 1.\+25\+Hz, 2.\+5\+Hz, 5\+Hz, 10\+Hz, 20\+Hz, 40\+Hz, 80\+Hz, 160\+Hz, 320\+Hz, 640\+Hz ~\newline
 If the requested rate is not one listed above, the device will be set to the next highest rate. Requesting a rate above the maximum supported frequency will result in an error. ~\newline
 To select a fractional wake-\/up frequency, round down the value passed to {\itshape rate}. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+lp\+\_\+motion\+\_\+interrupt} (int fd, unsigned short thresh, unsigned char time, unsigned short lpa\+\_\+freq)
\begin{DoxyCompactList}\small\item\em Enters LP accel motion interrupt mode. The behaviour of this feature is very different between the M\+P\+U6050 and the M\+P\+U6500. Each chip\textquotesingle{}s version of this feature is explained below. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+set\+\_\+int\+\_\+level} (unsigned char active\+\_\+low)
\begin{DoxyCompactList}\small\item\em Set interrupt level. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+set\+\_\+int\+\_\+latched} (int fd, unsigned char enable)
\begin{DoxyCompactList}\small\item\em Enable latched interrupts. Any M\+PU register will clear the interrupt. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+set\+\_\+dmp\+\_\+state} (int fd, unsigned char enable)
\begin{DoxyCompactList}\small\item\em Enable/disable D\+MP support. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+get\+\_\+dmp\+\_\+state} (unsigned char $\ast$enabled)
\begin{DoxyCompactList}\small\item\em Get D\+MP state. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+get\+\_\+lpf} (unsigned short $\ast$lpf)
\begin{DoxyCompactList}\small\item\em Get the current D\+L\+PF setting. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+set\+\_\+lpf} (int fd, unsigned short lpf)
\begin{DoxyCompactList}\small\item\em Set digital low pass filter. The following L\+PF settings are supported\+: 188, 98, 42, 20, 10, 5. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+get\+\_\+gyro\+\_\+fsr} (unsigned short $\ast$fsr)
\begin{DoxyCompactList}\small\item\em Get the gyro full-\/scale range. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+set\+\_\+gyro\+\_\+fsr} (int fd, unsigned short fsr)
\begin{DoxyCompactList}\small\item\em Set the gyro full-\/scale range. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+get\+\_\+accel\+\_\+fsr} (unsigned char $\ast$fsr)
\begin{DoxyCompactList}\small\item\em Get the accel full-\/scale range. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+set\+\_\+accel\+\_\+fsr} (int fd, unsigned char fsr)
\begin{DoxyCompactList}\small\item\em Set the accel full-\/scale range. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+get\+\_\+compass\+\_\+fsr} (unsigned short $\ast$fsr)
\begin{DoxyCompactList}\small\item\em Get the compass full-\/scale range. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+get\+\_\+gyro\+\_\+sens} (float $\ast$sens)
\begin{DoxyCompactList}\small\item\em Get gyro sensitivity scale factor. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+get\+\_\+accel\+\_\+sens} (unsigned short $\ast$sens)
\begin{DoxyCompactList}\small\item\em Get accel sensitivity scale factor. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+get\+\_\+sample\+\_\+rate} (unsigned short $\ast$rate)
\begin{DoxyCompactList}\small\item\em Get sampling rate. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+set\+\_\+sample\+\_\+rate} (int fd, unsigned short rate)
\begin{DoxyCompactList}\small\item\em Set sampling rate. Sampling rate must be between 4\+Hz and 1k\+Hz. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+get\+\_\+compass\+\_\+sample\+\_\+rate} (unsigned short $\ast$rate)
\begin{DoxyCompactList}\small\item\em Get compass sampling rate. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+set\+\_\+compass\+\_\+sample\+\_\+rate} (int fd, unsigned short rate)
\begin{DoxyCompactList}\small\item\em Set compass sampling rate. The compass on the auxiliary I2C bus is read by the M\+PU hardware at a maximum of 100\+Hz. The actual rate can be set to a fraction of the gyro sampling rate. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+get\+\_\+fifo\+\_\+config} (unsigned char $\ast$sensors)
\begin{DoxyCompactList}\small\item\em Get current F\+I\+FO configuration. {\itshape sensors} can contain a combination of the following flags\+: ~\newline
 I\+N\+V\+\_\+\+X\+\_\+\+G\+Y\+RO, I\+N\+V\+\_\+\+Y\+\_\+\+G\+Y\+RO, I\+N\+V\+\_\+\+Z\+\_\+\+G\+Y\+RO ~\newline
 I\+N\+V\+\_\+\+X\+Y\+Z\+\_\+\+G\+Y\+RO ~\newline
 I\+N\+V\+\_\+\+X\+Y\+Z\+\_\+\+A\+C\+C\+EL. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+configure\+\_\+fifo} (int fd, unsigned char sensors)
\begin{DoxyCompactList}\small\item\em Select which sensors are pushed to F\+I\+FO. {\itshape sensors} can contain a combination of the following flags\+: ~\newline
 I\+N\+V\+\_\+\+X\+\_\+\+G\+Y\+RO, I\+N\+V\+\_\+\+Y\+\_\+\+G\+Y\+RO, I\+N\+V\+\_\+\+Z\+\_\+\+G\+Y\+RO ~\newline
 I\+N\+V\+\_\+\+X\+Y\+Z\+\_\+\+G\+Y\+RO ~\newline
 I\+N\+V\+\_\+\+X\+Y\+Z\+\_\+\+A\+C\+C\+EL. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+get\+\_\+power\+\_\+state} (unsigned char $\ast$power\+\_\+on)
\begin{DoxyCompactList}\small\item\em Get current power state. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+set\+\_\+sensors} (int fd, unsigned char sensors)
\begin{DoxyCompactList}\small\item\em Turn specific sensors on/off. {\itshape sensors} can contain a combination of the following flags\+: ~\newline
 I\+N\+V\+\_\+\+X\+\_\+\+G\+Y\+RO, I\+N\+V\+\_\+\+Y\+\_\+\+G\+Y\+RO, I\+N\+V\+\_\+\+Z\+\_\+\+G\+Y\+RO ~\newline
 I\+N\+V\+\_\+\+X\+Y\+Z\+\_\+\+G\+Y\+RO ~\newline
 I\+N\+V\+\_\+\+X\+Y\+Z\+\_\+\+A\+C\+C\+EL ~\newline
 I\+N\+V\+\_\+\+X\+Y\+Z\+\_\+\+C\+O\+M\+P\+A\+SS. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+read\+\_\+6500\+\_\+accel\+\_\+bias} (int fd, long $\ast$accel\+\_\+bias)
\begin{DoxyCompactList}\small\item\em Read biases to the accel bias 6500 registers. This function reads from the M\+P\+U6500 accel offset cancellations registers. The format are G in +-\/8G format. The register is initialized with O\+TP factory trim values. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+set\+\_\+gyro\+\_\+bias\+\_\+reg} (int fd, long $\ast$gyro\+\_\+bias)
\begin{DoxyCompactList}\small\item\em Push biases to the gyro bias 6500/6050 registers. This function expects biases relative to the current sensor output, and these biases will be added to the factory-\/supplied values. Bias inputs are L\+SB in +-\/1000dps format. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+set\+\_\+accel\+\_\+bias\+\_\+6500\+\_\+reg} (int fd, const long $\ast$accel\+\_\+bias)
\begin{DoxyCompactList}\small\item\em Push biases to the accel bias 6500 registers. This function expects biases relative to the current sensor output, and these biases will be added to the factory-\/supplied values. Bias inputs are L\+SB in +-\/16G format. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+read\+\_\+6050\+\_\+accel\+\_\+bias} (int fd, long $\ast$accel\+\_\+bias)
\begin{DoxyCompactList}\small\item\em Read biases to the accel bias 6050 registers. This function reads from the M\+P\+U6050 accel offset cancellations registers. The format are G in +-\/8G format. The register is initialized with O\+TP factory trim values. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+set\+\_\+accel\+\_\+bias\+\_\+6050\+\_\+reg} (int fd, const long $\ast$accel\+\_\+bias)
\begin{DoxyCompactList}\small\item\em Push biases to the accel bias 6050 registers. This function expects biases relative to the current sensor output, and these biases will be added to the factory-\/supplied values. Bias inputs are L\+SB in +-\/16G format. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+get\+\_\+gyro\+\_\+reg} (int fd, short $\ast$data, unsigned long $\ast$timestamp)
\begin{DoxyCompactList}\small\item\em Read raw gyro data directly from the registers. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+get\+\_\+accel\+\_\+reg} (int fd, short $\ast$data, unsigned long $\ast$timestamp)
\begin{DoxyCompactList}\small\item\em Read raw accel data directly from the registers. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+get\+\_\+compass\+\_\+reg} (int fd, short $\ast$data, unsigned long $\ast$timestamp)
\begin{DoxyCompactList}\small\item\em Read raw compass data. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+get\+\_\+temperature} (int fd, long $\ast$data, unsigned long $\ast$timestamp)
\begin{DoxyCompactList}\small\item\em Read temperature data directly from the registers. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+get\+\_\+int\+\_\+status} (int fd, short $\ast$status)
\begin{DoxyCompactList}\small\item\em Read the M\+PU interrupt status registers. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+read\+\_\+fifo} (int fd, short $\ast$gyro, short $\ast$accel, unsigned long $\ast$timestamp, unsigned char $\ast$sensors, unsigned char $\ast$more)
\begin{DoxyCompactList}\small\item\em Get one packet from the F\+I\+FO. If {\itshape sensors} does not contain a particular sensor, disregard the data returned to that pointer. ~\newline
 {\itshape sensors} can contain a combination of the following flags\+: ~\newline
 I\+N\+V\+\_\+\+X\+\_\+\+G\+Y\+RO, I\+N\+V\+\_\+\+Y\+\_\+\+G\+Y\+RO, I\+N\+V\+\_\+\+Z\+\_\+\+G\+Y\+RO ~\newline
 I\+N\+V\+\_\+\+X\+Y\+Z\+\_\+\+G\+Y\+RO ~\newline
 I\+N\+V\+\_\+\+X\+Y\+Z\+\_\+\+A\+C\+C\+EL ~\newline
 If the F\+I\+FO has no new data, {\itshape sensors} will be zero. ~\newline
 If the F\+I\+FO is disabled, {\itshape sensors} will be zero and this function will return a non-\/zero error code. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+read\+\_\+fifo\+\_\+stream} (int fd, unsigned short length, unsigned char $\ast$data, unsigned char $\ast$more)
\begin{DoxyCompactList}\small\item\em Get one unparsed packet from the F\+I\+FO. This function should be used if the packet is to be parsed elsewhere. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+reset\+\_\+fifo} (int fd)
\begin{DoxyCompactList}\small\item\em Reset F\+I\+FO read/write pointers. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+write\+\_\+mem} (int fd, unsigned short mem\+\_\+addr, unsigned short length, unsigned char $\ast$data)
\begin{DoxyCompactList}\small\item\em Write to the D\+MP memory. This function prevents I2C writes past the bank boundaries. The D\+MP memory is only accessible when the chip is awake. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+read\+\_\+mem} (int fd, unsigned short mem\+\_\+addr, unsigned short length, unsigned char $\ast$data)
\begin{DoxyCompactList}\small\item\em Read from the D\+MP memory. This function prevents I2C reads past the bank boundaries. The D\+MP memory is only accessible when the chip is awake. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+load\+\_\+firmware} (int fd, unsigned short length, const unsigned char $\ast$firmware, unsigned short start\+\_\+addr, unsigned short sample\+\_\+rate)
\begin{DoxyCompactList}\small\item\em Load and verify D\+MP image. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+reg\+\_\+dump} (int fd)
\begin{DoxyCompactList}\small\item\em Register dump for testing. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+read\+\_\+reg} (int fd, unsigned char reg, unsigned char $\ast$data)
\begin{DoxyCompactList}\small\item\em Read from a single register. N\+O\+TE\+: The memory and F\+I\+FO read/write registers cannot be accessed. \end{DoxyCompactList}\item 
int \textbf{ mpu\+\_\+run\+\_\+self\+\_\+test} (int fd, long $\ast$gyro, long $\ast$accel)
\item 
int \textbf{ mpu\+\_\+run\+\_\+6500\+\_\+self\+\_\+test} (int fd, long $\ast$gyro, long $\ast$accel, unsigned char debug)
\item 
int \textbf{ mpu\+\_\+register\+\_\+tap\+\_\+cb} (void($\ast$func)(unsigned char, unsigned char))
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\mbox{\label{mpu_8h_a7cc5adf4e7dc9af23d6349c0a8dd2fa1}} 
\index{mpu.\+h@{mpu.\+h}!delay\+\_\+ms@{delay\+\_\+ms}}
\index{delay\+\_\+ms@{delay\+\_\+ms}!mpu.\+h@{mpu.\+h}}
\subsubsection{delay\+\_\+ms}
{\footnotesize\ttfamily \#define delay\+\_\+ms(\begin{DoxyParamCaption}\item[{}]{t }\end{DoxyParamCaption})~usleep(t$\ast$1000)}

\mbox{\label{mpu_8h_a3e6b6bc6d1cd2956353a31bfadd3c332}} 
\index{mpu.\+h@{mpu.\+h}!get\+\_\+ms@{get\+\_\+ms}}
\index{get\+\_\+ms@{get\+\_\+ms}!mpu.\+h@{mpu.\+h}}
\subsubsection{get\+\_\+ms}
{\footnotesize\ttfamily \#define get\+\_\+ms~\textbf{ i2c\+\_\+get\+\_\+ms}}

\mbox{\label{mpu_8h_ab354affc295f7d61fe8a355c9361cc5a}} 
\index{mpu.\+h@{mpu.\+h}!log\+\_\+e@{log\+\_\+e}}
\index{log\+\_\+e@{log\+\_\+e}!mpu.\+h@{mpu.\+h}}
\subsubsection{log\+\_\+e}
{\footnotesize\ttfamily \#define log\+\_\+e~printf}

\mbox{\label{mpu_8h_a2905fba7885cd95057e1655cb4d16bda}} 
\index{mpu.\+h@{mpu.\+h}!log\+\_\+i@{log\+\_\+i}}
\index{log\+\_\+i@{log\+\_\+i}!mpu.\+h@{mpu.\+h}}
\subsubsection{log\+\_\+i}
{\footnotesize\ttfamily \#define log\+\_\+i~printf}

\mbox{\label{mpu_8h_ac6afabdc09a49a433ee19d8a9486056d}} 
\index{mpu.\+h@{mpu.\+h}!min@{min}}
\index{min@{min}!mpu.\+h@{mpu.\+h}}
\subsubsection{min}
{\footnotesize\ttfamily \#define min(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{b }\end{DoxyParamCaption})~( (a $<$ b) ? a \+: b )}

